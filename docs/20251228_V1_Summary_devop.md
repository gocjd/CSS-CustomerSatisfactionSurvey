# 고객만족도 조사 시스템 (CSS) - 개발 이력 및 현황 (DevOps Summary)

## 0. 변경 이력 (Change Log)

| 날짜 | 버전 | 변경 내용 | 작성 주체 |
|------|------|----------|----------|
| 2025-12-28 | v1.3 | 뷰포트 NaN 보호/복구 로직, 미니맵 UI 고도화, 엄격한 전체 경로 검증 도입 | AI Assistant |
| 2025-12-28 | v1.2 | 소스 분석 기반 문서 갱신, 라이브러리 정리, 이미지 아이템 추가 | AI Assistant |
| 2025-12-27 | v1.1 | 엣지 시스템 고도화, 이미지 아이템 디자인 | AI Assistant |
| 2025-12-26 | v1.0 | DevOps Summary 초안 작성 | AI Assistant |
| 2025-12-25 | v1.0 | Architecture 및 Detailed Design 완료 | AI Assistant |

---

## Document Information
- **최종 수정일**: 2025-12-28
- **작성자**: AI Assistant (DevOps & Implementation Analysis)
- **버전**: v1.3
- **근거 문서**: 
  - `@[docs/20251226_v1_summary_devop.md]`
  - `@[docs/20251225_v1_summary_antigravity.md]`
  - `@[docs/20251225_v1_summary_claude.md]`

---

## 1. 개요 (Overview)

본 문서는 2025-12-26 이후 진행된 **추가 개발 및 수정 사항**을 상세히 기록합니다. 초기 설계의 비전("Google Opal 스타일의 시각적 빌더")을 유지하면서, 특히 **환경의 안정성(Stability)**과 **데이터의 무결성(Validation)**을 보장하기 위한 고도화 작업이 집중적으로 이루어졌습니다.

---

## 2. 핵심 구현 및 수정 이력 (Key Implementations & Modifications)

### 2-1. 노드 그래프 & 연결성 고도화 (Graph UX)

#### A. 정밀 연결 시스템 (Precision Connection)
- **해결 (The `::after` Technique)**: 실제 핸들은 작게 유지하되, CSS 의사 요소를 통해 보이지 않는 거대한 클릭 영역(280px)을 생성하여 "대충 던져도 정확히 맺히는" UX 달성.

#### B. 노드 로직 방어 (Node Logic Constraints)
- **순환 참조 및 중복 연결 차단**: BFS 기반 사이클 탐지 및 동일 핸들 중복 연결 방지 로직 탑재.

#### C. 엄격한 전체 경로 검증 (Strict Path Validation)
- **모든 경로 도달 원칙**: 단순히 하나의 경로가 종료에 닿는 것이 아니라, 노드에서 파생되는 **모든 분기(옵션)**가 최종적으로 '종료(End)' 노드에 도달해야만 유효한 것으로 판정.
- **에러 전파 로직**: 하위 경로의 결함이 발생할 경우, 해당 노드뿐만 아니라 상위로 거슬러 올라가며 모든 관련 노드와 **시작(Start) 노드**까지 에러 상태(빨간색 테두리)를 표시하도록 강화.

---

### 2-2. 미니맵(MiniMap) 시스템 고도화

#### A. 시각적 편의성 개선
- **z-index 상향 (100)**: 플로팅 미니맵이 왼쪽 조작 패널 뒤로 숨겨지는 문제를 해결.
- **헤더 UI 확장**: 헤더 높이를 키우고, 설문 제목을 더 크고 굵게 표시하여 식별력 강화.

#### B. 안정성 확보 (Stability)
- **내부 줌 비활성화**: 미니맵 내에서의 휠 줌 기능을 꺼서 좌표 계산 오류(`NaN`) 가능성을 사전에 차단.
- **하이드레이션 안전성**: SSR(서버 사이드 렌더링) 중에 `window` 객체 접근을 방지하여 Next.js 하이드레이션 오류 해결.

---

### 2-3. 캔버스 안정성 및 오류 복구 (Stability & Recovery)

#### A. 실시간 뷰포트 감시 (onMove Recovery)
- **NaN 자동 감지 및 리셋**: 미니맵 조작 등으로 인해 브라우저가 캔버스 좌표를 `NaN`으로 계산하는 현상을 실시간 감시.
- **자동 치유**: `NaN` 감지 시 즉시 뷰포트를 기본 좌표로 강제 리셋하여 시스템 마비 방지.

#### B. 측정 정확도 향상
- **CSS 트랜지션 제거**: `QuestionNode`, `StartNode` 등에서 `transition-all` 속성을 제거하여 React Flow가 노드 크기를 측정할 때 발생하는 오차(애니메이션 도중 측정 오류)를 제거.
- **지연된 fitView**: 초기 데이터 로드 시 500ms의 지연 시간을 두어 컨테이너 크기가 확정된 후 최적의 뷰를 맞추도록 수정.

---

### 2-4. 상호작용 및 조작 방식 복원 (UX Restoration)

- **Space + Drag 이동 방식**: 마우스 왼쪽 클릭 드래그는 노드 선택 및 범위 선택(Selection)에 우선 할당.
- **팬 이동(Pan)**: 사용자의 요청에 따라 스페이스바를 누른 상태에서만 드래그로 캔버스를 이동할 수 있도록 복원하여 조작의 일관성 확보.

---

### 2-5. 헤더 및 프로젝트 관리

- **프로젝트 명칭 연동**: 좌상단 파일명 표시 부분을 `Project: [설문이름]` 형식으로 개선하여 현재 작업 중인 내용을 명확히 인지하도록 디자인 보강.
- **시작/종료 노드 시각화**: 시작 지점의 연결이나 경로가 유효하지 않을 때 시작 노드 자체에 빨간색 경고 애니메이션을 적용하여 직관적인 피드백 제공.

---

## 3. 현재 시스템 현황 (Current System Status)

### 3-1. 구현 완료 (Completed - v1.3 기반)
- [x] **Strict Validation**: 모든 분기가 종료에 닿아야 하는 엄격한 검증 체계.
- [x] **Auto Recovery**: 뷰포트 NaN 오류 발생 시 자동 복구 시스템.
- [x] **Stability Nodes**: CSS 트랜지션을 제거하여 정밀 측정을 보장하는 노드 컴포넌트.
- [x] **Enhanced MiniMap**: z-index 보정, 헤더 확장, SSR 안전성 확보.
- [x] **UX Restoration**: 스페이스바 기반 캔버스 이동 및 드래그 선택 기능 공존.
- [x] **Project Linking**: 헤더와 스토어 간의 설문 제목 연동 강화.

---

## 4. 기술 스택 (Technology Stack)
*(기존 v1.2 내용 유지 및 최신화)*
- **Next.js 16.1.1**, **@xyflow/react 12.10.0**, **Zustand 5.0.9** 등

---

## 5. 프로젝트 구조 및 테스트 방법
*(기존 내용 유지)*
- **테스트 방법**: `npm run dev` 실행 후 `http://localhost:5000` 접속.
- **에이전트 검증**: 브라우저 도구를 활용한 캔버스 이동 및 경로 유효성 자동 검증 완료.

---

## 9. 업데이트 가이드 및 마감

**이하 부분은 v1.3 업데이트의 끝입니다.**

> [!NOTE]
> **향후 업데이트 방법**:
> 이 문서의 내용을 기반으로 새로운 기능 구현이나 버그 수정 시 `0. 변경 이력` 섹션을 최신화하고, 관련 내용을 본문에 추가 또는 수정해 주시기 바랍니다. 업데이트가 완료되면 이 주석 하단에 신규 이력을 덧붙여 주십시오.

---
**문서 업데이트 종료 (v1.3)**
---

